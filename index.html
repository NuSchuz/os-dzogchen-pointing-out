<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OpenSpace — Pointing-Out Teachings</title>
  <style>
    :root{
      --bg:#000;
      --fg:#fff;
      --muted:#8a8a8a;
      --card:#0e0e10;
      --btn:#1e1e1e;
      --btnHover:#2b2b2b;
      --radius:12px;
    }
    html,body{height:100%;margin:0}
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:var(--fg);
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
      padding:18px;
      box-sizing:border-box;
    }

    #container{width:min(720px,96vw);max-width:820px}
    h2{margin:0 0 14px;font-weight:600;font-size:1.15rem;text-align:center}
    #card{
      background:var(--card);
      padding:20px;
      border-radius:var(--radius);
      box-shadow:0 8px 28px rgba(0,0,0,.6);
      position:relative;
    }

    #content{
      min-height:110px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      border-radius:10px;
      background:transparent;
      color:var(--fg);
      font-size:1.05rem;
      line-height:1.5;
      text-align:center;
      opacity:0;
      transition:opacity .45s ease;
    }

    .controls{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:center;
      margin-top:18px;
    }

    button{
      background:var(--btn);
      color:var(--fg);
      border:none;
      padding:12px 16px;
      border-radius:10px;
      cursor:pointer;
      font-size:1.1rem;
      transition:opacity .12s,transform .12s,background .12s;
    }
    button:hover:not(:disabled){ background:var(--btnHover); transform:translateY(-1px); }
    button:disabled{ opacity:.32; cursor:default; background:#0a0a0a; color:var(--muted); }

    #stepBtn,#cycleBtn{ width:56px; height:56px; border-radius:10px; font-size:20px }
    #anchorBtn{ width:38px; height:34px; border-radius:8px; font-size:16px; padding:6px 8px }

    #menuBar{display:flex;gap:10px;justify-content:center;margin-bottom:16px;}

    #anchorArea{ margin-top:12px; min-height:46px; display:flex; align-items:center; justify-content:center }
    #anchorText{
      opacity:0;
      transition:opacity 15000ms ease;
      color:var(--muted);
      text-align:center;
      max-width:82%;
      font-size:0.95rem;
      line-height:1.45;
    }
  </style>
</head>
<body>
  <div id="container">
    <h2>OpenSpace — Pointing-Out Teachings</h2>

    <div id="menuBar">
      <button id="dzogchenBtn">Dzogchen Freeform</button>
      <button id="mahaBtn">Mahamudra Pointing-Out</button>
    </div>

    <div id="card">
      <div id="content">Select a teaching to begin.</div>

      <div class="controls" aria-hidden="false">
        <button id="stepBtn" aria-label="Step" disabled>●</button>
        <button id="cycleBtn" aria-label="Next iteration" disabled>○</button>
      </div>

      <div style="display:flex;flex-direction:column;align-items:center">
        <div style="margin-top:10px;"><button id="anchorBtn" aria-label="Anchor" disabled>⚓</button></div>
        <div id="anchorArea"><div id="anchorText"></div></div>
      </div>
    </div>
  </div>

<script>
let teachingMode = null;
let mahaIndex = 0;

const mahamudra = [
  "Sit comfortably. Eyes open, gaze lowered.",
  "Relax jaw, lips apart, tongue on palate.",
  "Let the gaze fall naturally; thoughts slow.",
  "Notice the pervasive stillness already present.",
  "A thought arises — and dissolves instantly.",
  "Feelings, sensations, perceptions arise and vanish.",
  "Notice what moves and what does not.",
  "Return attention gently to stillness.",
  "Movement arises in stillness, made of stillness.",
  "Movement and stillness share the same essence.",
  "Look between thoughts — the gap is the natural state.",
  "You have never left the nature of mind.",
  "Recognize directly, without effort."
];

const content = document.getElementById('content');
const stepBtn = document.getElementById('stepBtn');
const cycleBtn = document.getElementById('cycleBtn');
const anchorBtn = document.getElementById('anchorBtn');

function fade(t){ content.style.opacity=0; setTimeout(()=>{content.textContent=t; content.style.opacity=1;},450);} 

// Existing Dzogchen logic preserved
const maxPhase = 4;
let phase = 0;

function startDzogchen(){ teachingMode="dzogchen"; phase=0; stepBtn.disabled=false; cycleBtn.disabled=true; anchorBtn.disabled=true; fade("Click the left dot to begin."); }

document.getElementById('dzogchenBtn').onclick=startDzogchen;

document.getElementById('mahaBtn').onclick=()=>{
  teachingMode="mahamudra";
  mahaIndex=0;
  stepBtn.disabled=false;
  cycleBtn.disabled=true;
  anchorBtn.disabled=true;
  fade("Mahamudra — click the dot to begin.");
};

function step(){
  if(stepBtn.disabled) return;

  if(teachingMode==="mahamudra"){
    fade(mahamudra[mahaIndex]);
    mahaIndex++;
    if(mahaIndex>=mahamudra.length){ stepBtn.disabled=true; showMahaEnd(); }
    return;
  }

  fade("(Dzogchen step placeholder — reintegrate your logic here)");
}

stepBtn.onclick=step;

function showMahaEnd(){
  fade("Teaching complete.");
  setTimeout(()=>{
    fade("Repeat or return to Dzogchen.");
    const card=document.querySelector('#card');

    const repeat=document.createElement('button');
    repeat.textContent="Repeat Mahamudra";
    repeat.style.margin="12px";
    repeat.onclick=()=>{
      mahaIndex=0;
      stepBtn.disabled=false;
      fade("Mahamudra — click the dot to begin.");
      repeat.remove(); back.remove();
    };

    const back=document.createElement('button');
    back.textContent="Return to Menu";
    back.style.margin="12px";
    back.onclick=()=>{
      repeat.remove(); back.remove();
      content.textContent="Select a teaching to begin.";
      teachingMode=null;
      stepBtn.disabled=true;
      cycleBtn.disabled=true;
      anchorBtn.disabled=true;
    };

    card.appendChild(repeat); card.appendChild(back);
  },900);
}
</script>
</body>
</html>
